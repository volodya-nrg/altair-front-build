function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{Lvw3:function(e,t,i){"use strict";i.r(t),i.d(t,"ProfileModule",(function(){return E}));var n,r=i("ofXK"),o=i("3Pt+"),a=i("tyNb"),s=i("JzmT"),l=i("fXoL"),c=i("lGQG"),f=((n=function(){function e(t,i){_classCallCheck(this,e),this.serviceAuth=t,this.router=i,this.subscriptions=[]}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"logout",value:function(){var e=this,t=this.serviceAuth.logout().subscribe((function(t){e.serviceAuth.JWT="",localStorage.clear(),e.serviceAuth.profile$.next(null),e.router.navigate(["/main"]).then()}));this.subscriptions.push(t)}}]),e}()).\u0275fac=function(e){return new(e||n)(l.Kb(c.a),l.Kb(a.c))},n.\u0275cmp=l.Eb({type:n,selectors:[["app-page-profile"]],decls:18,vars:0,consts:[[1,"page-profile"],[1,"page-profile_cols"],[1,"page-profile_cols_col","sx-menu"],[1,"page-profile_links"],[1,"text-eclipse"],["href","javascript:void(0)","routerLink","/profile/info","routerLinkActive","active"],["href","javascript:void(0)","routerLink","/profile/ads","routerLinkActive","active"],["href","javascript:void(0)","routerLink","/profile/settings","routerLinkActive","active"],["href","javascript:void(0)",3,"click"],[1,"page-profile_cols_col","sx-content"]],template:function(e,t){1&e&&(l.Qb(0,"div",0),l.Qb(1,"div",1),l.Qb(2,"div",2),l.Qb(3,"ul",3),l.Qb(4,"li",4),l.Qb(5,"a",5),l.uc(6," \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 "),l.Pb(),l.Pb(),l.Qb(7,"li",4),l.Qb(8,"a",6),l.uc(9,"\u041c\u043e\u0438 \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u044f"),l.Pb(),l.Pb(),l.Qb(10,"li",4),l.Qb(11,"a",7),l.uc(12,"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"),l.Pb(),l.Pb(),l.Qb(13,"li",4),l.Qb(14,"a",8),l.Yb("click",(function(){return t.logout()})),l.uc(15,"\u0412\u044b\u0445\u043e\u0434"),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(16,"div",9),l.Lb(17,"router-outlet"),l.Pb(),l.Pb(),l.Pb())},directives:[a.f,a.e,a.h],styles:[".page-profile[_ngcontent-%COMP%]{margin-top:1em}.page-profile_cols[_ngcontent-%COMP%]{display:flex}.page-profile_cols_col[_ngcontent-%COMP%] + .page-profile_cols_col[_ngcontent-%COMP%]{margin-left:1em}.page-profile_cols_col.sx-content[_ngcontent-%COMP%]{flex-basis:100%}.page-profile_links[_ngcontent-%COMP%]{display:block;width:15em;margin:0;padding:0;list-style:none}.page-profile_links[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] + li[_ngcontent-%COMP%]{margin-top:.5em;padding-top:.5em;border-top:.0625em solid #f5f5f5}.page-profile_links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{text-decoration:none}"]}),n),u=i("Afm0"),p=i("AytR"),b=function(){var e=function e(){_classCallCheck(this,e)};return e.PasswordsValidator=function(e){var t=e.get("passwordOld").value,i=e.get("passwordNew").value,n=e.get("passwordConfirm").value;return t&&(t=t.trim()),i&&(i=i.trim()),n&&(n=n.trim()),!t&&!i&&!n||t&&i===n?null:{passwordsError:"\u043e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0430\u0440\u043e\u043b\u044f\u0445"}},e}(),d=i("Aso2"),g=["avatar"];function h(e,t){if(1&e){var i=l.Rb();l.Ob(0),l.Qb(1,"div",22),l.Yb("click",(function(e){return l.nc(i),l.ac().deletePhoto(e)})),l.uc(2,"\xd7 "),l.Pb(),l.Lb(3,"img",23),l.Nb()}if(2&e){var n=l.ac();l.zb(3),l.gc("src",n.url+"/resample/0/320/"+n.profile.avatar,l.pc)}}function v(e,t){if(1&e&&(l.Qb(0,"div",6),l.uc(1),l.bc(2,"json"),l.Pb()),2&e){var i=l.ac();l.zb(1),l.wc(" ",l.cc(2,1,i.form.value)," ")}}var m,y,P=((y=function(){function e(t,i,n,r){_classCallCheck(this,e),this.fb=t,this.serviceProfile=i,this.serviceAuth=n,this.router=r,this.subscriptions=[],this.attentionMsg="\u0412\u044b \u0442\u043e\u0447\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c?\n\u041e\u043d \u0438 \u0432\u0441\u0435 \u0441\u043e\u043f\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0443\u0434\u0430\u043b\u044f\u0442\u0441\u044f \u0431\u0435\u0437\u0432\u043e\u0432\u0437\u0440\u0430\u0432\u043d\u043e.\n\u041f\u043e\u0441\u043b\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0443\u0436\u0435 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0441\u044f.",this.avatarSave="",this.url=p.a.apiUrl,this.isProdMode=p.a.production,this.form=this.fb.group({files:"",avatar:"",name:"",email:"",passwordOld:["",o.n.minLength(p.a.minLenPassword)],passwordNew:["",o.n.minLength(p.a.minLenPassword)],passwordConfirm:["",o.n.minLength(p.a.minLenPassword)]},{validators:b.PasswordsValidator})}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=this.serviceAuth.profile$.subscribe((function(t){e.profile=t,t&&e.form.patchValue(t)}));this.subscriptions.push(t)}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"ngAfterViewInit",value:function(){}},{key:"onSubmit",value:function(e){var t=this,i=e.target;if(this.form.invalid)for(var n in this.form.hasError("passwordsError")&&console.log(this.form.getError("passwordsError")),this.form.controls)"INVALID"===this.form.get(n).status&&console.log("INVALID:",n);else{var r=u.a.getNewFormData(this.form.value),o=i.querySelector('[type="submit"]');i.classList.add("sx-loading"),o.disabled=!0;var a=this.serviceProfile.update(r).subscribe((function(e){i.reset(),t.form.reset(),t.serviceAuth.profile$.next(e),t.avatarSave="",t.form.patchValue({passwordOld:"",passwordNew:"",passwordConfirm:""})}),(function(e){o.disabled=!1,i.classList.remove("sx-loading")}),(function(){o.disabled=!1,i.classList.remove("sx-loading")}));this.subscriptions.push(a)}}},{key:"deleteProfile",value:function(e){var t=this,i=e.target;if(confirm(this.attentionMsg)){i.disable=!0;var n=this.serviceProfile.delete().subscribe((function(e){t.serviceAuth.logout().subscribe((function(e){return t.serviceAuth.JWT=""})),t.router.navigate(["/main"]).then()}),(function(e){return i.disable=!1}),(function(){return i.disable=!1}));this.subscriptions.push(n)}}},{key:"addPhoto",value:function(e){var t=e.target;u.a.addPhoto(t,this.form)}},{key:"deletePhoto",value:function(e){_objectDestructuringEmpty(e);var t=this.avatar.nativeElement;t.classList.contains("sx-statement")?(t.classList.remove("sx-statement"),this.form.get("avatar").setValue(this.avatarSave)):(t.classList.add("sx-statement"),this.avatarSave=this.form.get("avatar").value,this.form.get("avatar").setValue(""),this.form.markAsDirty())}}]),e}()).\u0275fac=function(e){return new(e||y)(l.Kb(o.d),l.Kb(d.a),l.Kb(c.a),l.Kb(a.c))},y.\u0275cmp=l.Eb({type:y,selectors:[["app-page-profile-info"]],viewQuery:function(e,t){var i;1&e&&l.rc(g,!0),2&e&&l.lc(i=l.Zb())&&(t.avatar=i.first)},decls:47,vars:7,consts:[[1,"page-profile-info"],[1,"page-profile-info_flexbox"],[1,"page-profile-info_avatar"],["avatar",""],[4,"ngIf"],[1,"form",3,"formGroup","ngSubmit"],[1,"form_row"],[1,"form_title"],["type","hidden","formControlName","files"],["type","file","accept","image/jpeg,image/png",3,"change"],["formControlName","email","type","email","readonly","readonly"],["formControlName","name","type","text"],["formControlName","passwordOld","type","text"],["formControlName","passwordNew","type","text"],["formControlName","passwordConfirm","type","text"],["type","submit","value","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",3,"disabled"],[1,"form_row","align-right"],[1,"text-mute"],["class","form_row",4,"ngIf"],[1,"hr"],[1,"align-right"],[3,"click"],["title","\u0443\u0434\u0430\u043b\u0438\u0442\u044c",1,"page-profile-info_avatar_delete",3,"click"],[3,"src"]],template:function(e,t){1&e&&(l.Qb(0,"div",0),l.Qb(1,"div",1),l.Qb(2,"div"),l.Qb(3,"div",2,3),l.sc(5,h,4,1,"ng-container",4),l.Pb(),l.Pb(),l.Qb(6,"div"),l.Qb(7,"form",5),l.Yb("ngSubmit",(function(e){return t.onSubmit(e)})),l.Qb(8,"div",6),l.Qb(9,"div",7),l.uc(10,"\u0410\u0432\u0430\u0442\u0430\u0440:"),l.Pb(),l.Lb(11,"input",8),l.Qb(12,"input",9),l.Yb("change",(function(e){return t.addPhoto(e)})),l.Pb(),l.Pb(),l.Qb(13,"div",6),l.Qb(14,"div",7),l.uc(15,"\u0415-\u043c\u044d\u0439\u043b:"),l.Pb(),l.Lb(16,"input",10),l.Pb(),l.Qb(17,"div",6),l.Qb(18,"div",7),l.uc(19,"\u0418\u043c\u044f:"),l.Pb(),l.Lb(20,"input",11),l.Pb(),l.Qb(21,"div",6),l.Qb(22,"div",7),l.uc(23,"\u041f\u0430\u0440\u043e\u043b\u044c:"),l.Pb(),l.Lb(24,"input",12),l.Pb(),l.Qb(25,"div",6),l.Qb(26,"div",7),l.uc(27,"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c:"),l.Pb(),l.Lb(28,"input",13),l.Pb(),l.Qb(29,"div",6),l.Qb(30,"div",7),l.uc(31,"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c (\u043f\u043e\u0432\u0442\u043e\u0440):"),l.Pb(),l.Lb(32,"input",14),l.Pb(),l.Qb(33,"div",6),l.Lb(34,"input",15),l.Pb(),l.Qb(35,"div",16),l.Qb(36,"span",17),l.uc(37,"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"),l.Pb(),l.uc(38),l.bc(39,"date"),l.Pb(),l.sc(40,v,3,3,"div",18),l.Pb(),l.Pb(),l.Pb(),l.Lb(41,"br"),l.Lb(42,"hr",19),l.Lb(43,"br"),l.Qb(44,"div",20),l.Qb(45,"button",21),l.Yb("click",(function(e){return t.deleteProfile(e)})),l.uc(46,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"),l.Pb(),l.Pb(),l.Pb()),2&e&&(l.zb(5),l.gc("ngIf",null==t.profile?null:t.profile.avatar),l.zb(2),l.gc("formGroup",t.form),l.zb(27),l.gc("disabled",t.form.invalid||t.form.pristine),l.zb(4),l.wc(": ",l.cc(39,5,null==t.profile?null:t.profile.createdAt)," "),l.zb(2),l.gc("ngIf",!t.isProdMode))},directives:[r.k,o.p,o.h,o.f,o.b,o.g,o.e],pipes:[r.d,r.f],styles:[".page-profile-info_flexbox[_ngcontent-%COMP%]{display:flex}.page-profile-info_flexbox[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-basis:100%}.page-profile-info_flexbox[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{flex:0 0 15em}.page-profile-info_flexbox[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){margin-left:1em}.page-profile-info_avatar[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:15em;height:20em;overflow:hidden;background-color:#f5f5f5}.page-profile-info_avatar.sx-statement[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.5}.page-profile-info_avatar_delete[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex;justify-content:center;align-items:center;font-size:1.5em;width:1em;height:1em;background-color:hsla(0,0%,100%,.7);cursor:pointer}.page-profile-info_avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.page-profile-info[_ngcontent-%COMP%]   .form.sx-loading[_ngcontent-%COMP%]{opacity:.7}"]}),y),_=((m=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||m)},m.\u0275cmp=l.Eb({type:m,selectors:[["app-page-profile-settings"]],decls:1,vars:0,consts:[[1,"page-profile-settings"]],template:function(e,t){1&e&&l.Lb(0,"div",0)},styles:[""]}),m),w=i("g87O"),C=i("qi+E"),k=["preloader"];function L(e,t){1&e&&l.Lb(0,"app-ad",5),2&e&&l.gc("ad",t.$implicit)("inProfile",!0)}function O(e,t){if(1&e&&(l.Qb(0,"div"),l.sc(1,L,1,2,"app-ad",4),l.Pb()),2&e){var i=l.ac();l.zb(1),l.gc("ngForOf",i.ads)}}var A,Q,x,M=[{path:"",redirectTo:"info",pathMatch:"full"},{path:"",component:f,children:[{path:"info",component:P},{path:"settings",component:_},{path:"ads",component:(A=function(){function e(t,i){_classCallCheck(this,e),this.serviceProfile=t,this.serviceAuth=i,this.subscriptions=[],this.limit=3,this.offset=0,this.ads=[],this.isLoading=!1,this.isLoadAll=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loadMoreForScroll=this.loadMore.bind(this);var t=this.serviceAuth.profile$.subscribe((function(t){e.profile=t,t&&e.send()}));this.subscriptions.push(t)}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()})),this.removeScroll()}},{key:"ngAfterViewInit",value:function(){this.addScroll()}},{key:"addScroll",value:function(){window.addEventListener("scroll",this.loadMoreForScroll)}},{key:"removeScroll",value:function(){window.removeEventListener("scroll",this.loadMoreForScroll)}},{key:"send",value:function(){var e=this;this.isLoading=!0;var t=this.serviceProfile.getAds(this.limit,this.offset).subscribe((function(t){var i;(i=e.ads).push.apply(i,_toConsumableArray(t)),e.offset+=e.limit,t.length<e.limit?e.isLoadAll=!0:e.loadMore()}),(function(t){return e.isLoading=!1}),(function(){return e.isLoading=!1}));this.subscriptions.push(t)}},{key:"loadMore",value:function(){this.preloader.nativeElement.getBoundingClientRect().top>window.innerHeight||this.isLoading||this.isLoadAll||this.send()}}]),e}(),A.\u0275fac=function(e){return new(e||A)(l.Kb(d.a),l.Kb(c.a))},A.\u0275cmp=l.Eb({type:A,selectors:[["app-page-profile-ads"]],viewQuery:function(e,t){var i;1&e&&l.rc(k,!0),2&e&&l.lc(i=l.Zb())&&(t.preloader=i.first)},decls:5,vars:4,consts:[[1,"page-profile-ads"],[4,"ngIf"],[3,"hidden"],["preloader",""],["viewOpt","line",3,"ad","inProfile",4,"ngFor","ngForOf"],["viewOpt","line",3,"ad","inProfile"]],template:function(e,t){1&e&&(l.Qb(0,"div",0),l.sc(1,O,2,1,"div",1),l.Qb(2,"div",2,3),l.Lb(4,"app-preloader"),l.Pb(),l.Pb()),2&e&&(l.zb(1),l.gc("ngIf",t.ads.length),l.zb(1),l.Cb("not-visible",!t.isLoading),l.gc("hidden",t.isLoadAll))},directives:[r.k,w.a,r.j,C.a],styles:[""]}),A)}]},{path:"**",component:s.a}],I=((Q=function e(){_classCallCheck(this,e)}).\u0275mod=l.Ib({type:Q}),Q.\u0275inj=l.Hb({factory:function(e){return new(e||Q)},imports:[[a.g.forChild(M)],a.g]}),Q),S=i("FpXt"),E=((x=function e(){_classCallCheck(this,e)}).\u0275mod=l.Ib({type:x}),x.\u0275inj=l.Hb({factory:function(e){return new(e||x)},imports:[[o.l,r.b,a.g,I,S.a]]}),x)}}]);